function insertData(book) {
    let bookData = [];

    const storedData = localStorage.getItem(localStorageKey);

    if (!storedData) {
        alert(`Data buku [BERHASIL DITAMBAHKAN]`);
        bookData = [];
    } else {
        alert(`Data buku [BERHASIL DITAMBAHKAN]`);
        bookData = JSON.parse(storedData);
    }

    bookData.unshift(book);
    localStorage.setItem(localStorageKey, JSON.stringify(bookData));

    showData(getData());
}

function getData() {
    return JSON.parse(localStorage.getItem(localStorageKey)) || [];
}

function showData(books = []) {
    const inCompleted = document.querySelector("#incompleteBookshelfList");
    const completed = document.querySelector("#completeBookshelfList");

    inCompleted.innerHTML = '';
    completed.innerHTML = '';

    const incompleteBooks = books.filter(book => book.isCompleted == false);
    const completeBooks = books.filter(book => book.isCompleted == true);

    if (incompleteBooks.length > 0) {
        incompleteBooks.forEach(book => {
            let el = `
            <article class="book_item">
                <h3 style="text-align:left;">${book.title}</h3>
                <p style="text-align:left;">Penulis: ${book.author}</p>
                <p>Tahun: ${book.year}</p>

                <div class="action" style="margin-top: 30px;">
                    <button class="green select-none" onclick="readedBook('${book.id}')">
                        <svg class="agree-icon" style="top:10px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.000000 512.000000">
                            <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" fill="currentColor" stroke="none">
                                <path d="M728 4720 c-312 -54 -582 -288 -689 -598 l-34 -97 0 -1465 0 -1465 34 -97 c97 -280 326 -499 608 -580 l78 -23 1445 0 1445 0 90 28 c320 100 564 372 620 692 12 71 15 189 15 626 0 318 -4 548 -10 563 -11 30 -58 56 -101 56 -28 0 -50 -17 -160 -126 l-127 -126 -5 -457 c-3 -380 -6 -464 -19 -502 -55 -161 -163 -273 -324 -335 -47 -18 -106 -19 -1379 -22 -889 -2 -1353 1 -1400 8 -196 29 -369 196 -405 389 -14 73 -14 2669 0 2742 35 191 209 359 400 389 103 16 2657 13 2740 -3 38 -8 78 -10 96 -5 19 5 66 44 127 106 89 91 97 102 97 138 0 53 -22 82 -85 110 -143 63 -29 58 -1590 60 -781 1 -1441 -2 -1467 -6z"/>
                                <path d="M4425 4507 c-40 -20 -260 -235 -1055 -1031 l-1005 -1006 -420 419 c-231 230 -435 427 -454 436 -19 9 -60 20 -93 22 -105 10 -128 -5 -351 -226 -110 -108 -210 -214 -224 -236 -19 -29 -27 -57 -31 -107 -9 -131 -49 -83 727 -860 383 -383 712 -704 731 -714 49 -26 181 -26 230 0 19 10 612 595 1317 1300 1003 1002 1287 1291 1302 1326 28 61 28 159 0 220 -24 52 -393 427 -449 455 -20 11 -65 20 -105 22 -59 3 -78 0 -120 -20z"/>
                            </g>
                        </svg>
                        &nbsp;<span>Selesai dibaca</span>
                    </button>
                    <button class="red select-none" onclick="deleteBook('${book.id}')">
                        <svg class="disagree-icon" style="top:10px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.000000 512.000000">
                            <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" fill="currentColor" stroke="none">
                                <path d="M728 4720 c-312 -54 -582 -288 -689 -598 l-34 -97 0 -1465 0 -1465 34 -97 c97 -280 326 -499 608 -580 l78 -23 1445 0 1445 0 90 28 c320 100 564 372 620 692 12 71 15 189 15 626 0 318 -4 548 -10 563 -11 30 -58 56 -101 56 -28 0 -50 -17 -160 -126 l-127 -126 -5 -457 c-3 -380 -6 -464 -19 -502 -55 -161 -163 -273 -324 -335 -47 -18 -106 -19 -1379 -22 -889 -2 -1353 1 -1400 8 -196 29 -369 196 -405 389 -14 73 -14 2669 0 2742 35 191 209 359 400 389 103 16 2657 13 2740 -3 38 -8 78 -10 96 -5 19 5 66 44 127 106 89 91 97 102 97 138 0 53 -22 82 -85 110 -143 63 -29 58 -1590 60 -781 1 -1441 -2 -1467 -6z"/>
                                <path d="M4140 4421 c-43 -9 -95 -35 -137 -70 -17 -14 -51 -41 -75 -58 -207 -156 -258 -195 -289 -222 -20 -17 -41 -31 -46 -31 -5 0 -22 -13 -38 -30 -16 -16 -34 -30 -40 -30 -6 0 -26 -16 -45 -35 -19 -19 -39 -35 -45 -35 -7 0 -20 -10 -31 -21 -10 -12 -33 -31 -50 -43 -18 -11 -85 -61 -149 -111 -149 -114 -182 -138 -225 -170 -47 -34 -86 -64 -225 -170 -65 -49 -127 -97 -139 -105 -11 -8 -38 -28 -58 -45 -20 -16 -58 -46 -83 -65 -25 -19 -61 -47 -79 -62 -19 -16 -39 -28 -46 -28 -7 0 -221 206 -474 459 -254 252 -476 466 -495 476 -19 9 -60 20 -93 22 -105 10 -128 -5 -351 -226 -110 -108 -210 -214 -224 -236 -19 -29 -27 -57 -31 -107 -9 -126 -20 -112 450 -584 l420 -421 -59 -46 c-32 -25 -74 -60 -94 -76 -20 -17 -41 -31 -46 -31 -5 0 -22 -13 -38 -30 -16 -16 -34 -30 -40 -30 -6 0 -26 -16 -45 -35 -19 -19 -39 -35 -45 -35 -7 0 -20 -10 -31 -21 -10 -12 -33 -31 -50 -43 -18 -11 -85 -61 -149 -111 -170 -130 -186 -142 -225 -168 -19 -14 -42 -32 -50 -42 -8 -9 -23 -21 -35 -25 -32 -12 -77 -113 -80 -179 -2 -47 3 -66 31 -121 19 -36 51 -86 72 -111 20 -26 78 -100 127 -165 118 -156 160 -201 209 -225 39 -19 126 -27 171 -16 35 8 101 46 125 72 13 14 28 25 33 25 5 0 27 15 47 33 21 17 58 47 82 64 46 35 224 170 298 228 25 19 62 47 83 62 21 15 55 43 76 61 21 17 42 32 46 32 4 0 25 15 45 33 21 17 58 46 82 64 23 18 63 48 88 67 93 73 47 103 443 -291 194 -193 367 -359 386 -368 19 -9 60 -20 93 -22 105 -10 128 5 351 226 110 108 210 214 224 236 19 29 27 57 31 107 9 123 8 124 -339 473 l-308 310 100 75 c156 117 182 137 220 169 20 17 41 31 46 31 5 0 24 16 43 35 18 19 36 33 38 30 3 -3 24 12 48 33 23 20 63 53 90 72 26 19 59 46 75 60 15 14 78 63 139 110 62 47 130 99 151 115 21 17 57 44 79 60 23 17 58 45 79 63 21 17 42 32 46 32 4 0 25 15 45 33 21 17 58 47 82 64 76 58 251 192 304 233 63 50 96 113 99 189 3 67 -25 132 -101 230 -27 35 -58 75 -69 91 -11 15 -40 53 -65 85 -25 32 -54 70 -65 85 -39 54 -92 106 -126 126 -40 24 -118 35 -169 25z"/>
                            </g>
                        </svg>
                        &nbsp;<span>Hapus buku</span>
                    </button>
                </div>
            </article>
            `;
            inCompleted.innerHTML += el;
        });
    } else {
        inCompleted.innerHTML = `
        <article class="book_item empty">
            <h3 style="text-align: center; color: red; margin: 20px 0;">
                [BELUM ADA DATA]
            </h3>
            <p class="p-empty">
                Harap Tambahkan Data Terlebih Dahulu !!
            </p>
        </article>
        `;
    }

    if (completeBooks.length > 0) {
        completeBooks.forEach(book => {
            let el = `
            <article class="book_item">
                <h3 style="text-align:left;">${book.title}</h3>
                <p style="text-align:left;">Penulis: ${book.author}</p>
                <p>Tahun: ${book.year}</p>

                <div class="action" style="margin-top: 30px;">
                    <button class="green select-none" onclick="unreadedBook('${book.id}')"> 
                        <svg class="agree-icon" style="top:10px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.000000 512.000000">
                            <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" fill="currentColor" stroke="none">
                                <path d="M728 4720 c-312 -54 -582 -288 -689 -598 l-34 -97 0 -1465 0 -1465 34 -97 c97 -280 326 -499 608 -580 l78 -23 1445 0 1445 0 90 28 c320 100 564 372 620 692 12 71 15 189 15 626 0 318 -4 548 -10 563 -11 30 -58 56 -101 56 -28 0 -50 -17 -160 -126 l-127 -126 -5 -457 c-3 -380 -6 -464 -19 -502 -55 -161 -163 -273 -324 -335 -47 -18 -106 -19 -1379 -22 -889 -2 -1353 1 -1400 8 -196 29 -369 196 -405 389 -14 73 -14 2669 0 2742 35 191 209 359 400 389 103 16 2657 13 2740 -3 38 -8 78 -10 96 -5 19 5 66 44 127 106 89 91 97 102 97 138 0 53 -22 82 -85 110 -143 63 -29 58 -1590 60 -781 1 -1441 -2 -1467 -6z"/>
                                <path d="M4425 4507 c-40 -20 -260 -235 -1055 -1031 l-1005 -1006 -420 419 c-231 230 -435 427 -454 436 -19 9 -60 20 -93 22 -105 10 -128 -5 -351 -226 -110 -108 -210 -214 -224 -236 -19 -29 -27 -57 -31 -107 -9 -131 -49 -83 727 -860 383 -383 712 -704 731 -714 49 -26 181 -26 230 0 19 10 612 595 1317 1300 1003 1002 1287 1291 1302 1326 28 61 28 159 0 220 -24 52 -393 427 -449 455 -20 11 -65 20 -105 22 -59 3 -78 0 -120 -20z"/>
                            </g>
                        </svg>
                        &nbsp;<span>Belum selesai dibaca</span>
                    </button>
                    <button class="red select-none" onclick="deleteBook('${book.id}')">
                        <svg class="disagree-icon" style="top:10px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.000000 512.000000">
                            <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" fill="currentColor" stroke="none">
                                <path d="M728 4720 c-312 -54 -582 -288 -689 -598 l-34 -97 0 -1465 0 -1465 34 -97 c97 -280 326 -499 608 -580 l78 -23 1445 0 1445 0 90 28 c320 100 564 372 620 692 12 71 15 189 15 626 0 318 -4 548 -10 563 -11 30 -58 56 -101 56 -28 0 -50 -17 -160 -126 l-127 -126 -5 -457 c-3 -380 -6 -464 -19 -502 -55 -161 -163 -273 -324 -335 -47 -18 -106 -19 -1379 -22 -889 -2 -1353 1 -1400 8 -196 29 -369 196 -405 389 -14 73 -14 2669 0 2742 35 191 209 359 400 389 103 16 2657 13 2740 -3 38 -8 78 -10 96 -5 19 5 66 44 127 106 89 91 97 102 97 138 0 53 -22 82 -85 110 -143 63 -29 58 -1590 60 -781 1 -1441 -2 -1467 -6z"/>
                                <path d="M4140 4421 c-43 -9 -95 -35 -137 -70 -17 -14 -51 -41 -75 -58 -207 -156 -258 -195 -289 -222 -20 -17 -41 -31 -46 -31 -5 0 -22 -13 -38 -30 -16 -16 -34 -30 -40 -30 -6 0 -26 -16 -45 -35 -19 -19 -39 -35 -45 -35 -7 0 -20 -10 -31 -21 -10 -12 -33 -31 -50 -43 -18 -11 -85 -61 -149 -111 -149 -114 -182 -138 -225 -170 -47 -34 -86 -64 -225 -170 -65 -49 -127 -97 -139 -105 -11 -8 -38 -28 -58 -45 -20 -16 -58 -46 -83 -65 -25 -19 -61 -47 -79 -62 -19 -16 -39 -28 -46 -28 -7 0 -221 206 -474 459 -254 252 -476 466 -495 476 -19 9 -60 20 -93 22 -105 10 -128 -5 -351 -226 -110 -108 -210 -214 -224 -236 -19 -29 -27 -57 -31 -107 -9 -126 -20 -112 450 -584 l420 -421 -59 -46 c-32 -25 -74 -60 -94 -76 -20 -17 -41 -31 -46 -31 -5 0 -22 -13 -38 -30 -16 -16 -34 -30 -40 -30 -6 0 -26 -16 -45 -35 -19 -19 -39 -35 -45 -35 -7 0 -20 -10 -31 -21 -10 -12 -33 -31 -50 -43 -18 -11 -85 -61 -149 -111 -170 -130 -186 -142 -225 -168 -19 -14 -42 -32 -50 -42 -8 -9 -23 -21 -35 -25 -32 -12 -77 -113 -80 -179 -2 -47 3 -66 31 -121 19 -36 51 -86 72 -111 20 -26 78 -100 127 -165 118 -156 160 -201 209 -225 39 -19 126 -27 171 -16 35 8 101 46 125 72 13 14 28 25 33 25 5 0 27 15 47 33 21 17 58 47 82 64 46 35 224 170 298 228 25 19 62 47 83 62 21 15 55 43 76 61 21 17 42 32 46 32 4 0 25 15 45 33 21 17 58 46 82 64 23 18 63 48 88 67 93 73 47 103 443 -291 194 -193 367 -359 386 -368 19 -9 60 -20 93 -22 105 -10 128 5 351 226 110 108 210 214 224 236 19 29 27 57 31 107 9 123 8 124 -339 473 l-308 310 100 75 c156 117 182 137 220 169 20 17 41 31 46 31 5 0 24 16 43 35 18 19 36 33 38 30 3 -3 24 12 48 33 23 20 63 53 90 72 26 19 59 46 75 60 15 14 78 63 139 110 62 47 130 99 151 115 21 17 57 44 79 60 23 17 58 45 79 63 21 17 42 32 46 32 4 0 25 15 45 33 21 17 58 47 82 64 76 58 251 192 304 233 63 50 96 113 99 189 3 67 -25 132 -101 230 -27 35 -58 75 -69 91 -11 15 -40 53 -65 85 -25 32 -54 70 -65 85 -39 54 -92 106 -126 126 -40 24 -118 35 -169 25z"/>
                            </g>
                        </svg>
                        &nbsp;<span>Hapus buku</span>
                    </button>
                </div>
            </article>
            `;
            completed.innerHTML += el;
        });
    } else {
        completed.innerHTML = `
        <article class="book_item empty">
            <h3 style="text-align: center; color: red; margin: 20px 0;">
                [BELUM ADA DATA]
            </h3>
            <p class="p-empty">
                Harap Tambahkan Data Terlebih Dahulu !!
            </p>
        </article>
        `;
    }
}

document.addEventListener('DOMContentLoaded', function() {
    showData(getData());
});

function deleteBook(id) {
    let cfm = confirm("Anda yakin akan menghapus data buku ini ?");

    if (cfm == true) {
        const bookDataDetail = getData().filter(a => a.id == id);
        const bookData = getData().filter(a => a.id != id);
        localStorage.setItem(localStorageKey,JSON.stringify(bookData));
        showData(getData());
        alert(`[Buku ${bookDataDetail[0].title}] telah terhapus dari rak`);
    }else{
        return 0;
    }
}